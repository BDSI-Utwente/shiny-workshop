<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Karel Kroeze">

<title>Adaptive inputs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="adaptive-inputs_files/libs/clipboard/clipboard.min.js"></script>
<script src="adaptive-inputs_files/libs/quarto-html/quarto.js"></script>
<script src="adaptive-inputs_files/libs/quarto-html/popper.min.js"></script>
<script src="adaptive-inputs_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="adaptive-inputs_files/libs/quarto-html/anchor.min.js"></script>
<link href="adaptive-inputs_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="adaptive-inputs_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="adaptive-inputs_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="adaptive-inputs_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="adaptive-inputs_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Adaptive inputs</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Karel Kroeze </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="the-problem" class="level2">
<h2 class="anchored" data-anchor-id="the-problem">The problem</h2>
<p>The goal of most shiny apps let the user interact with some dataset. We’ll set up inputs to match the different variables in the dataset, perhaps to select a variable, filter on a column, and so forth.</p>
<p>Consider a simple app designed to query (old) billboard top 100 data. A first iteration might simply show a table of tracks.</p>
<p>We can then let the user show the top 10 songs or artists in 1999-2000 (the data covers 1999-06-05 to 2000-12-30). The shiny UI for this is simple:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">radioButtons</span>(<span class="st">"top_type"</span>, <span class="st">"Show top..."</span>, <span class="fu">c</span>(<span class="st">"artists"</span>, <span class="st">"tracks"</span>), <span class="at">inline =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="top_type" class="form-group shiny-input-radiogroup shiny-input-container shiny-input-container-inline" role="radiogroup" aria-labelledby="top_type-label">
<label class="control-label" id="top_type-label" for="top_type">Show top...</label>
<div class="shiny-options-group">
<label class="radio-inline">
<input type="radio" name="top_type" value="artists" checked="checked">
<span>artists</span>
</label>
<label class="radio-inline">
<input type="radio" name="top_type" value="tracks">
<span>tracks</span>
</label>
</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tableOutput</span>(<span class="st">"top_10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="top_10" class="shiny-html-output"></div>
</div>
</div>
<p>With a simple <code>if</code> statement to select aggregate by track or artist, depending on the selected input.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>top_10 <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># count weeks in ranking, then sort descending</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (input<span class="sc">$</span>top_type <span class="sc">==</span> <span class="st">"artists"</span>) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    weeks_in_ranking <span class="ot">&lt;-</span> billboard_long <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(artist)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (input<span class="sc">$</span>top_type <span class="sc">==</span> <span class="st">"tracks"</span>) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    weeks_in_ranking <span class="ot">&lt;-</span> billboard_long <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(artist, track)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  weeks_in_ranking <span class="sc">%&gt;%</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">`</span><span class="at">weeks</span><span class="st">`</span> <span class="ot">=</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This works great, because we know in advance which variables we have, and their number is rather limited. What happens if we have a dataset with dozens, if not hundreds, of variables? What happens if we want to let the user select values, not variables?</p>
<p>Imagine that our manager requested that not only do we show the top artists and tracks, we also allow users to show a graph for how a song performed over time. We’ll need a way to let the user select artists and tracks. We could theoretically go over the list of all artists and tracks and manually create an input with all these inputs, but the simpler option is to just derive the available options from the data.</p>
<p>The UI is again relatively straightforward:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">selectInput</span>(<span class="st">"artist"</span>, <span class="st">"Choose an artist"</span>, billboard <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(artist))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="artist-label" for="artist">Choose an artist</label>
<div>
<select id="artist" class="shiny-input-select"><optgroup label="artist">
<option value="2 Pac" selected="">2 Pac</option>
<option value="2Ge+her">2Ge+her</option>
<option value="3 Doors Down">3 Doors Down</option>
<option value="504 Boyz">504 Boyz</option>
<option value="98^0">98^0</option>
<option value="A*Teens">A*Teens</option>
<option value="Aaliyah">Aaliyah</option>
<option value="Adams, Yolanda">Adams, Yolanda</option>
<option value="Adkins, Trace">Adkins, Trace</option>
<option value="Aguilera, Christina">Aguilera, Christina</option>
<option value="Alice Deejay">Alice Deejay</option>
<option value="Allan, Gary">Allan, Gary</option>
<option value="Amber">Amber</option>
<option value="Anastacia">Anastacia</option>
<option value="Anthony, Marc">Anthony, Marc</option>
<option value="Avant">Avant</option>
<option value="BBMak">BBMak</option>
<option value="Backstreet Boys, The">Backstreet Boys, The</option>
<option value="Badu, Erkyah">Badu, Erkyah</option>
<option value="Baha Men">Baha Men</option>
<option value="Barenaked Ladies">Barenaked Ladies</option>
<option value="Beenie Man">Beenie Man</option>
<option value="Before Dark">Before Dark</option>
<option value="Bega, Lou">Bega, Lou</option>
<option value="Big Punisher">Big Punisher</option>
<option value="Black Rob">Black Rob</option>
<option value="Black, Clint">Black, Clint</option>
<option value="Blaque">Blaque</option>
<option value="Blige, Mary J.">Blige, Mary J.</option>
<option value="Blink-182">Blink-182</option>
<option value="Bloodhound Gang">Bloodhound Gang</option>
<option value="Bon Jovi">Bon Jovi</option>
<option value="Braxton, Toni">Braxton, Toni</option>
<option value="Brock, Chad">Brock, Chad</option>
<option value="Brooks &amp; Dunn">Brooks &amp; Dunn</option>
<option value="Brooks, Garth">Brooks, Garth</option>
<option value="Byrd, Tracy">Byrd, Tracy</option>
<option value="Cagle, Chris">Cagle, Chris</option>
<option value="Cam'ron">Cam'ron</option>
<option value="Carey, Mariah">Carey, Mariah</option>
<option value="Carter, Aaron">Carter, Aaron</option>
<option value="Carter, Torrey">Carter, Torrey</option>
<option value="Changing Faces">Changing Faces</option>
<option value="Chesney, Kenny">Chesney, Kenny</option>
<option value="Clark Family Experience">Clark Family Experience</option>
<option value="Clark, Terri">Clark, Terri</option>
<option value="Common">Common</option>
<option value="Counting Crows">Counting Crows</option>
<option value="Creed">Creed</option>
<option value="Cyrus, Billy Ray">Cyrus, Billy Ray</option>
<option value="D'Angelo">D'Angelo</option>
<option value="DMX">DMX</option>
<option value="Da Brat">Da Brat</option>
<option value="Davidson, Clay">Davidson, Clay</option>
<option value="De La Soul">De La Soul</option>
<option value="Destiny's Child">Destiny's Child</option>
<option value="Diffie, Joe">Diffie, Joe</option>
<option value="Dion, Celine">Dion, Celine</option>
<option value="Dixie Chicks, The">Dixie Chicks, The</option>
<option value="Dr. Dre">Dr. Dre</option>
<option value="Drama">Drama</option>
<option value="Dream">Dream</option>
<option value="Eastsidaz, The">Eastsidaz, The</option>
<option value="Eiffel 65">Eiffel 65</option>
<option value="Elliott, Missy &quot;Misdemeanor&quot;">Elliott, Missy "Misdemeanor"</option>
<option value="Eminem">Eminem</option>
<option value="En Vogue">En Vogue</option>
<option value="Estefan, Gloria">Estefan, Gloria</option>
<option value="Evans, Sara">Evans, Sara</option>
<option value="Eve">Eve</option>
<option value="Everclear">Everclear</option>
<option value="Fabian, Lara">Fabian, Lara</option>
<option value="Fatboy Slim">Fatboy Slim</option>
<option value="Filter">Filter</option>
<option value="Foo Fighters">Foo Fighters</option>
<option value="Fragma">Fragma</option>
<option value="Funkmaster Flex">Funkmaster Flex</option>
<option value="Ghostface Killah">Ghostface Killah</option>
<option value="Gill, Vince">Gill, Vince</option>
<option value="Gilman, Billy">Gilman, Billy</option>
<option value="Ginuwine">Ginuwine</option>
<option value="Goo Goo Dolls">Goo Goo Dolls</option>
<option value="Gray, Macy">Gray, Macy</option>
<option value="Griggs, Andy">Griggs, Andy</option>
<option value="Guy">Guy</option>
<option value="Hanson">Hanson</option>
<option value="Hart, Beth">Hart, Beth</option>
<option value="Heatherly, Eric">Heatherly, Eric</option>
<option value="Henley, Don">Henley, Don</option>
<option value="Herndon, Ty">Herndon, Ty</option>
<option value="Hill, Faith">Hill, Faith</option>
<option value="Hoku">Hoku</option>
<option value="Hollister, Dave">Hollister, Dave</option>
<option value="Hot Boys">Hot Boys</option>
<option value="Houston, Whitney">Houston, Whitney</option>
<option value="IMx">IMx</option>
<option value="Ice Cube">Ice Cube</option>
<option value="Ideal">Ideal</option>
<option value="Iglesias, Enrique">Iglesias, Enrique</option>
<option value="J-Shin">J-Shin</option>
<option value="Ja Rule">Ja Rule</option>
<option value="Jackson, Alan">Jackson, Alan</option>
<option value="Jagged Edge">Jagged Edge</option>
<option value="Janet">Janet</option>
<option value="Jay-Z">Jay-Z</option>
<option value="Jean, Wyclef">Jean, Wyclef</option>
<option value="Joe">Joe</option>
<option value="John, Elton">John, Elton</option>
<option value="Jones, Donell">Jones, Donell</option>
<option value="Jordan, Montell">Jordan, Montell</option>
<option value="Juvenile">Juvenile</option>
<option value="Kandi">Kandi</option>
<option value="Keith, Toby">Keith, Toby</option>
<option value="Kelis">Kelis</option>
<option value="Kenny G">Kenny G</option>
<option value="Kid Rock">Kid Rock</option>
<option value="Kravitz, Lenny">Kravitz, Lenny</option>
<option value="Kumbia Kings">Kumbia Kings</option>
<option value="LFO">LFO</option>
<option value="LL Cool J">LL Cool J</option>
<option value="Larrieux, Amel">Larrieux, Amel</option>
<option value="Lawrence, Tracy">Lawrence, Tracy</option>
<option value="Levert, Gerald">Levert, Gerald</option>
<option value="Lil Bow Wow">Lil Bow Wow</option>
<option value="Lil Wayne">Lil Wayne</option>
<option value="Lil' Kim">Lil' Kim</option>
<option value="Lil' Mo">Lil' Mo</option>
<option value="Lil' Zane">Lil' Zane</option>
<option value="Limp Bizkit">Limp Bizkit</option>
<option value="Lonestar">Lonestar</option>
<option value="Lopez, Jennifer">Lopez, Jennifer</option>
<option value="Loveless, Patty">Loveless, Patty</option>
<option value="Lox">Lox</option>
<option value="Lucy Pearl">Lucy Pearl</option>
<option value="Ludacris">Ludacris</option>
<option value="M2M">M2M</option>
<option value="Madison Avenue">Madison Avenue</option>
<option value="Madonna">Madonna</option>
<option value="Martin, Ricky">Martin, Ricky</option>
<option value="Mary Mary">Mary Mary</option>
<option value="Master P">Master P</option>
<option value="McBride, Martina">McBride, Martina</option>
<option value="McEntire, Reba">McEntire, Reba</option>
<option value="McGraw, Tim">McGraw, Tim</option>
<option value="McKnight, Brian">McKnight, Brian</option>
<option value="Messina, Jo Dee">Messina, Jo Dee</option>
<option value="Metallica">Metallica</option>
<option value="Montgomery Gentry">Montgomery Gentry</option>
<option value="Montgomery, John Michael">Montgomery, John Michael</option>
<option value="Moore, Chante">Moore, Chante</option>
<option value="Moore, Mandy">Moore, Mandy</option>
<option value="Mumba, Samantha">Mumba, Samantha</option>
<option value="Musiq">Musiq</option>
<option value="Mya">Mya</option>
<option value="Mystikal">Mystikal</option>
<option value="N'Sync">N'Sync</option>
<option value="Nas">Nas</option>
<option value="Nelly">Nelly</option>
<option value="Next">Next</option>
<option value="Nine Days">Nine Days</option>
<option value="No Doubt">No Doubt</option>
<option value="Nu Flavor">Nu Flavor</option>
<option value="Offspring, The">Offspring, The</option>
<option value="Paisley, Brad">Paisley, Brad</option>
<option value="Papa Roach">Papa Roach</option>
<option value="Pearl Jam">Pearl Jam</option>
<option value="Pink">Pink</option>
<option value="Price, Kelly">Price, Kelly</option>
<option value="Profyle">Profyle</option>
<option value="Puff Daddy">Puff Daddy</option>
<option value="Q-Tip">Q-Tip</option>
<option value="R.E.M.">R.E.M.</option>
<option value="Rascal Flatts">Rascal Flatts</option>
<option value="Raye, Collin">Raye, Collin</option>
<option value="Red Hot Chili Peppers">Red Hot Chili Peppers</option>
<option value="Rimes, LeAnn">Rimes, LeAnn</option>
<option value="Rogers, Kenny">Rogers, Kenny</option>
<option value="Ruff Endz">Ruff Endz</option>
<option value="Sammie">Sammie</option>
<option value="Santana">Santana</option>
<option value="Savage Garden">Savage Garden</option>
<option value="SheDaisy">SheDaisy</option>
<option value="Sheist, Shade">Sheist, Shade</option>
<option value="Shyne">Shyne</option>
<option value="Simpson, Jessica">Simpson, Jessica</option>
<option value="Sisqo">Sisqo</option>
<option value="Sister Hazel">Sister Hazel</option>
<option value="Smash Mouth">Smash Mouth</option>
<option value="Smith, Will">Smith, Will</option>
<option value="Son By Four">Son By Four</option>
<option value="Sonique">Sonique</option>
<option value="SoulDecision">SoulDecision</option>
<option value="Spears, Britney">Spears, Britney</option>
<option value="Spencer, Tracie">Spencer, Tracie</option>
<option value="Splender">Splender</option>
<option value="Sting">Sting</option>
<option value="Stone Temple Pilots">Stone Temple Pilots</option>
<option value="Stone, Angie">Stone, Angie</option>
<option value="Strait, George">Strait, George</option>
<option value="Sugar Ray">Sugar Ray</option>
<option value="TLC">TLC</option>
<option value="Tamar">Tamar</option>
<option value="Tamia">Tamia</option>
<option value="Third Eye Blind">Third Eye Blind</option>
<option value="Thomas, Carl">Thomas, Carl</option>
<option value="Tippin, Aaron">Tippin, Aaron</option>
<option value="Train">Train</option>
<option value="Trick Daddy">Trick Daddy</option>
<option value="Trina">Trina</option>
<option value="Tritt, Travis">Tritt, Travis</option>
<option value="Tuesday">Tuesday</option>
<option value="Urban, Keith">Urban, Keith</option>
<option value="Usher">Usher</option>
<option value="Vassar, Phil">Vassar, Phil</option>
<option value="Vertical Horizon">Vertical Horizon</option>
<option value="Vitamin C">Vitamin C</option>
<option value="Walker, Clay">Walker, Clay</option>
<option value="Wallflowers, The">Wallflowers, The</option>
<option value="Westlife">Westlife</option>
<option value="Williams, Robbie">Williams, Robbie</option>
<option value="Wills, Mark">Wills, Mark</option>
<option value="Worley, Darryl">Worley, Darryl</option>
<option value="Wright, Chely">Wright, Chely</option>
<option value="Yankee Grey">Yankee Grey</option>
<option value="Yearwood, Trisha">Yearwood, Trisha</option>
<option value="Ying Yang Twins">Ying Yang Twins</option>
<option value="Zombie Nation">Zombie Nation</option>
<option value="matchbox twenty">matchbox twenty</option>
</optgroup></select>
<script type="application/json" data-for="artist" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">selectInput</span>(<span class="st">"track"</span>, <span class="st">"Choose a track"</span>, billboard <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(track))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="track-label" for="track">Choose a track</label>
<div>
<select id="track" class="shiny-input-select"><optgroup label="track">
<option value="Baby Don't Cry (Keep..." selected="">Baby Don't Cry (Keep...</option>
<option value="The Hardest Part Of ...">The Hardest Part Of ...</option>
<option value="Kryptonite">Kryptonite</option>
<option value="Loser">Loser</option>
<option value="Wobble Wobble">Wobble Wobble</option>
<option value="Give Me Just One Nig...">Give Me Just One Nig...</option>
<option value="Dancing Queen">Dancing Queen</option>
<option value="I Don't Wanna">I Don't Wanna</option>
<option value="Try Again">Try Again</option>
<option value="Open My Heart">Open My Heart</option>
<option value="More">More</option>
<option value="Come On Over Baby (A...">Come On Over Baby (A...</option>
<option value="I Turn To You">I Turn To You</option>
<option value="What A Girl Wants">What A Girl Wants</option>
<option value="Better Off Alone">Better Off Alone</option>
<option value="Smoke Rings In The D...">Smoke Rings In The D...</option>
<option value="Sexual">Sexual</option>
<option value="I'm Outta Love">I'm Outta Love</option>
<option value="My Baby You">My Baby You</option>
<option value="You Sang To Me">You Sang To Me</option>
<option value="My First Love">My First Love</option>
<option value="Separated">Separated</option>
<option value="Back Here">Back Here</option>
<option value="Shape Of My Heart">Shape Of My Heart</option>
<option value="Show Me The Meaning ...">Show Me The Meaning ...</option>
<option value="The One">The One</option>
<option value="Bag Lady">Bag Lady</option>
<option value="Who Let The Dogs Out">Who Let The Dogs Out</option>
<option value="Pinch Me">Pinch Me</option>
<option value="Girls Dem Sugar">Girls Dem Sugar</option>
<option value="Monica">Monica</option>
<option value="Tricky Tricky">Tricky Tricky</option>
<option value="It's So Hard">It's So Hard</option>
<option value="Whoa!">Whoa!</option>
<option value="Been There">Been There</option>
<option value="Bring It All To Me">Bring It All To Me</option>
<option value="Deep Inside">Deep Inside</option>
<option value="Give Me You">Give Me You</option>
<option value="All The Small Things">All The Small Things</option>
<option value="The Bad Touch">The Bad Touch</option>
<option value="It's My Life">It's My Life</option>
<option value="He Wasn't Man Enough">He Wasn't Man Enough</option>
<option value="Just Be A Man About ...">Just Be A Man About ...</option>
<option value="Spanish Guitar">Spanish Guitar</option>
<option value="A Country Boy Can Su...">A Country Boy Can Su...</option>
<option value="Yes!">Yes!</option>
<option value="You'll Always Be Lov...">You'll Always Be Lov...</option>
<option value="Do What You Gotta Do">Do What You Gotta Do</option>
<option value="Put Your Hand In Min...">Put Your Hand In Min...</option>
<option value="My Love Goes On And ...">My Love Goes On And ...</option>
<option value="What Means The World...">What Means The World...</option>
<option value="Crybaby">Crybaby</option>
<option value="Thank God I Found Yo...">Thank God I Found Yo...</option>
<option value="Aaron's Party (Come ...">Aaron's Party (Come ...</option>
<option value="Take That">Take That</option>
<option value="That Other Woman">That Other Woman</option>
<option value="I Lost It">I Lost It</option>
<option value="What I Need To Do">What I Need To Do</option>
<option value="Meanwhile Back At Th...">Meanwhile Back At Th...</option>
<option value="A Little Gasoline">A Little Gasoline</option>
<option value="The Light">The Light</option>
<option value="Hanginaround">Hanginaround</option>
<option value="Higher">Higher</option>
<option value="With Arms Wide Open">With Arms Wide Open</option>
<option value="You Won't Be Lonely ...">You Won't Be Lonely ...</option>
<option value="Left &amp; Right">Left &amp; Right</option>
<option value="Untitled (How Does I...">Untitled (How Does I...</option>
<option value="Party Up (Up In Here...">Party Up (Up In Here...</option>
<option value="What You Want">What You Want</option>
<option value="What's My Name">What's My Name</option>
<option value="That's What I'm Look...">That's What I'm Look...</option>
<option value="What'Chu Like">What'Chu Like</option>
<option value="Unconditional">Unconditional</option>
<option value="All Good?">All Good?</option>
<option value="Independent Women Pa...">Independent Women Pa...</option>
<option value="Jumpin' Jumpin'">Jumpin' Jumpin'</option>
<option value="Say My Name">Say My Name</option>
<option value="It's Always Somethin...">It's Always Somethin...</option>
<option value="The Quittin' Kind">The Quittin' Kind</option>
<option value="That's The Way It Is">That's The Way It Is</option>
<option value="Cold Day In July">Cold Day In July</option>
<option value="Cowboy Take Me Away">Cowboy Take Me Away</option>
<option value="Goodbye Earl">Goodbye Earl</option>
<option value="Without You">Without You</option>
<option value="Forgot About Dre">Forgot About Dre</option>
<option value="The Next Episode">The Next Episode</option>
<option value="Left, Right, Left">Left, Right, Left</option>
<option value="He Loves U Not">He Loves U Not</option>
<option value="G'D Up">G'D Up</option>
<option value="Got Beef">Got Beef</option>
<option value="Blue">Blue</option>
<option value="Hot Boyz">Hot Boyz</option>
<option value="Stan">Stan</option>
<option value="The Real Slim Shady">The Real Slim Shady</option>
<option value="The Way I Am">The Way I Am</option>
<option value="Riddle">Riddle</option>
<option value="No Me Dejes De Quere...">No Me Dejes De Quere...</option>
<option value="Born To Fly">Born To Fly</option>
<option value="Got It All">Got It All</option>
<option value="Love Is Blind">Love Is Blind</option>
<option value="Wonderful">Wonderful</option>
<option value="I Will Love Again">I Will Love Again</option>
<option value="The Rockafeller Skan...">The Rockafeller Skan...</option>
<option value="Take A Picture">Take A Picture</option>
<option value="Learn To Fly">Learn To Fly</option>
<option value="Toca's Miracle">Toca's Miracle</option>
<option value="Do You">Do You</option>
<option value="Cherchez LaGhost">Cherchez LaGhost</option>
<option value="Feels Like Love">Feels Like Love</option>
<option value="One Voice">One Voice</option>
<option value="None Of Ur Friends B...">None Of Ur Friends B...</option>
<option value="The Best Man I Can B...">The Best Man I Can B...</option>
<option value="Broadway">Broadway</option>
<option value="I Try">I Try</option>
<option value="She's More">She's More</option>
<option value="Dancin'">Dancin'</option>
<option value="This Time Around">This Time Around</option>
<option value="L.A. Song">L.A. Song</option>
<option value="Flowers On The Wall">Flowers On The Wall</option>
<option value="Taking You Home">Taking You Home</option>
<option value="No Mercy">No Mercy</option>
<option value="Breathe">Breathe</option>
<option value="Let's Make Love">Let's Make Love</option>
<option value="Another Dumb Blonde">Another Dumb Blonde</option>
<option value="Can't Stay">Can't Stay</option>
<option value="I Need A Hot Girl">I Need A Hot Girl</option>
<option value="Could I Have This Ki...">Could I Have This Ki...</option>
<option value="I Learned From The B...">I Learned From The B...</option>
<option value="My Love Is Your Love">My Love Is Your Love</option>
<option value="Same Script, Differe...">Same Script, Differe...</option>
<option value="Stay The Night">Stay The Night</option>
<option value="You Can Do It">You Can Do It</option>
<option value="Whatever">Whatever</option>
<option value="Be With You">Be With You</option>
<option value="Rhythm Divine">Rhythm Divine</option>
<option value="One Night Stand">One Night Stand</option>
<option value="Between Me And You">Between Me And You</option>
<option value="It Must Be Love">It Must Be Love</option>
<option value="Pop A Top">Pop A Top</option>
<option value="www.memory">www.memory</option>
<option value="He Can't Love U">He Can't Love U</option>
<option value="Let's Get Married">Let's Get Married</option>
<option value="Doesn't Really Matte...">Doesn't Really Matte...</option>
<option value="Anything">Anything</option>
<option value="Big Pimpin'">Big Pimpin'</option>
<option value="Do It Again (Put Ya ...">Do It Again (Put Ya ...</option>
<option value="Hey Papi">Hey Papi</option>
<option value="I Just Wanna Love U ...">I Just Wanna Love U ...</option>
<option value="911">911</option>
<option value="I Wanna Know">I Wanna Know</option>
<option value="Treat Her Like A Lad...">Treat Her Like A Lad...</option>
<option value="Someday Out Of The B...">Someday Out Of The B...</option>
<option value="Where I Wanna Be">Where I Wanna Be</option>
<option value="Get It On.. Tonite">Get It On.. Tonite</option>
<option value="U Understand">U Understand</option>
<option value="Don't Think I'm Not">Don't Think I'm Not</option>
<option value="Country Comes To Tow...">Country Comes To Tow...</option>
<option value="How Do You Like Me N...">How Do You Like Me N...</option>
<option value="Caught Out There">Caught Out There</option>
<option value="Auld Lang Syne (The ...">Auld Lang Syne (The ...</option>
<option value="Only God Knows Why">Only God Knows Why</option>
<option value="I Belong To You">I Belong To You</option>
<option value="U Don't Love Me">U Don't Love Me</option>
<option value="I Don't Wanna Kiss Y...">I Don't Wanna Kiss Y...</option>
<option value="West Side Story">West Side Story</option>
<option value="Imagine That">Imagine That</option>
<option value="Get Up">Get Up</option>
<option value="Lessons Learned">Lessons Learned</option>
<option value="Baby U Are">Baby U Are</option>
<option value="Mr. Too Damn Good">Mr. Too Damn Good</option>
<option value="Bounce With Me">Bounce With Me</option>
<option value="Tha Block Is Hot">Tha Block Is Hot</option>
<option value="How Many Licks?">How Many Licks?</option>
<option value="No Matter What They ...">No Matter What They ...</option>
<option value="Ta Da">Ta Da</option>
<option value="Callin' Me">Callin' Me</option>
<option value="N 2 Gether Now">N 2 Gether Now</option>
<option value="Re-Arranged">Re-Arranged</option>
<option value="Rollin'">Rollin'</option>
<option value="Amazed">Amazed</option>
<option value="Smile">Smile</option>
<option value="What About Now">What About Now</option>
<option value="Feelin' Good">Feelin' Good</option>
<option value="That's The Kind Of M...">That's The Kind Of M...</option>
<option value="Ryde or Die, Chick">Ryde or Die, Chick</option>
<option value="Dance Tonight">Dance Tonight</option>
<option value="What's Your Fantasy">What's Your Fantasy</option>
<option value="Don't Say You Love M...">Don't Say You Love M...</option>
<option value="Mirror Mirror">Mirror Mirror</option>
<option value="Don't Call Me Baby">Don't Call Me Baby</option>
<option value="American Pie">American Pie</option>
<option value="Music">Music</option>
<option value="Private Emotion">Private Emotion</option>
<option value="Shake Your Bon-Bon">Shake Your Bon-Bon</option>
<option value="She Bangs">She Bangs</option>
<option value="Shackles (Praise You...">Shackles (Praise You...</option>
<option value="Souljas">Souljas</option>
<option value="Love's The Only Hous...">Love's The Only Hous...</option>
<option value="There You Are">There You Are</option>
<option value="I'll Be">I'll Be</option>
<option value="What Do You Say">What Do You Say</option>
<option value="My Best Friend">My Best Friend</option>
<option value="My Next Thirty Years">My Next Thirty Years</option>
<option value="Some Things Never Ch...">Some Things Never Ch...</option>
<option value="Stay Or Let It Go">Stay Or Let It Go</option>
<option value="Because You Love Me">Because You Love Me</option>
<option value="That's The Way">That's The Way</option>
<option value="I Disappear">I Disappear</option>
<option value="No Leaf Clover (Live...">No Leaf Clover (Live...</option>
<option value="Daddy Won't Sell The...">Daddy Won't Sell The...</option>
<option value="The Little Girl">The Little Girl</option>
<option value="Straight Up">Straight Up</option>
<option value="I Wanna Be With You">I Wanna Be With You</option>
<option value="Gotta Tell You">Gotta Tell You</option>
<option value="Just Friends">Just Friends</option>
<option value="Case Of The Ex (What...">Case Of The Ex (What...</option>
<option value="The Best Of Me">The Best Of Me</option>
<option value="Shake Ya Ass">Shake Ya Ass</option>
<option value="Bye Bye Bye">Bye Bye Bye</option>
<option value="It's Gonna Be Me">It's Gonna Be Me</option>
<option value="This I Promise You">This I Promise You</option>
<option value="You Owe Me">You Owe Me</option>
<option value="(Hot S**t) Country G...">(Hot S**t) Country G...</option>
<option value="Wifey">Wifey</option>
<option value="Absolutely (Story Of...">Absolutely (Story Of...</option>
<option value="If I Am">If I Am</option>
<option value="Simple Kind Of Life">Simple Kind Of Life</option>
<option value="3 Little Words">3 Little Words</option>
<option value="Original Prankster">Original Prankster</option>
<option value="Me Neither">Me Neither</option>
<option value="We Danced">We Danced</option>
<option value="Last Resort">Last Resort</option>
<option value="Nothing As It Seems">Nothing As It Seems</option>
<option value="Most Girls">Most Girls</option>
<option value="There U Go">There U Go</option>
<option value="As We Lay">As We Lay</option>
<option value="Love Sets You Free">Love Sets You Free</option>
<option value="You Should've Told M...">You Should've Told M...</option>
<option value="Liar">Liar</option>
<option value="Best Friend">Best Friend</option>
<option value="Breathe And Stop">Breathe And Stop</option>
<option value="The Great Beyond">The Great Beyond</option>
<option value="Prayin' For Daylight">Prayin' For Daylight</option>
<option value="Couldn't Last A Mome...">Couldn't Last A Mome...</option>
<option value="Californication">Californication</option>
<option value="Otherside">Otherside</option>
<option value="Big Deal">Big Deal</option>
<option value="Can't Fight The Moon...">Can't Fight The Moon...</option>
<option value="I Need You">I Need You</option>
<option value="Buy Me A Rose">Buy Me A Rose</option>
<option value="No More">No More</option>
<option value="I Like It">I Like It</option>
<option value="Maria, Maria">Maria, Maria</option>
<option value="Crash And Burn">Crash And Burn</option>
<option value="I Knew I Loved You">I Knew I Loved You</option>
<option value="Deck The Halls">Deck The Halls</option>
<option value="I Will.. But">I Will.. But</option>
<option value="This Woman Needs">This Woman Needs</option>
<option value="Bad Boyz">Bad Boyz</option>
<option value="I Think I'm In Love ...">I Think I'm In Love ...</option>
<option value="Where You Are">Where You Are</option>
<option value="Got To Get It">Got To Get It</option>
<option value="Incomplete">Incomplete</option>
<option value="Thong Song">Thong Song</option>
<option value="Change Your Mind">Change Your Mind</option>
<option value="Then The Morning Com...">Then The Morning Com...</option>
<option value="Freakin' It">Freakin' It</option>
<option value="A Puro Dolor (Purest...">A Puro Dolor (Purest...</option>
<option value="It Feels So Good">It Feels So Good</option>
<option value="Faded">Faded</option>
<option value="From The Bottom Of M...">From The Bottom Of M...</option>
<option value="Lucky">Lucky</option>
<option value="Oops!.. I Did It Aga...">Oops!.. I Did It Aga...</option>
<option value="Still In My Heart">Still In My Heart</option>
<option value="I Think God Can Expl...">I Think God Can Expl...</option>
<option value="Desert Rose">Desert Rose</option>
<option value="Sour Girl">Sour Girl</option>
<option value="No More Rain (In Thi...">No More Rain (In Thi...</option>
<option value="Go On">Go On</option>
<option value="The Best Day">The Best Day</option>
<option value="Falls Apart">Falls Apart</option>
<option value="Dear Lie">Dear Lie</option>
<option value="If You Don't Wanna L...">If You Don't Wanna L...</option>
<option value="Can't Go For That">Can't Go For That</option>
<option value="Deep Inside Of You">Deep Inside Of You</option>
<option value="Never Let You Go">Never Let You Go</option>
<option value="Emotional">Emotional</option>
<option value="I Wish">I Wish</option>
<option value="Summer Rain">Summer Rain</option>
<option value="Kiss This">Kiss This</option>
<option value="Meet Virginia">Meet Virginia</option>
<option value="Shut Up">Shut Up</option>
<option value="Pull Over">Pull Over</option>
<option value="Best Of Intentions">Best Of Intentions</option>
<option value="I Know">I Know</option>
<option value="Your Everything">Your Everything</option>
<option value="Pop Ya Collar">Pop Ya Collar</option>
<option value="Carlene">Carlene</option>
<option value="Just Another Day In ...">Just Another Day In ...</option>
<option value="Everything You Want">Everything You Want</option>
<option value="You're A God">You're A God</option>
<option value="Graduation (Friends ...">Graduation (Friends ...</option>
<option value="The Itch">The Itch</option>
<option value="Live, Laugh, Love">Live, Laugh, Love</option>
<option value="The Chain Of Love">The Chain Of Love</option>
<option value="Sleepwalker">Sleepwalker</option>
<option value="Swear It Again">Swear It Again</option>
<option value="Angels">Angels</option>
<option value="Back At One">Back At One</option>
<option value="When You Need My Lov...">When You Need My Lov...</option>
<option value="It Was">It Was</option>
<option value="Another Nine Minutes">Another Nine Minutes</option>
<option value="Real Live Woman">Real Live Woman</option>
<option value="Whistle While You Tw...">Whistle While You Tw...</option>
<option value="Kernkraft 400">Kernkraft 400</option>
<option value="Bent">Bent</option>
</optgroup></select>
<script type="application/json" data-for="track" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotOutput</span>(<span class="st">"track_performance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="track_performance" style="width:100%;height:400px;"></div>
</div>
</div>
<p>As is the server, we’re again using user input to filter the data, which is then plotted in a simple line chart.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>track_performance <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter data with user choices</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  billboard_long <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(artist <span class="sc">==</span> input<span class="sc">$</span>artist, track <span class="sc">==</span> input<span class="sc">$</span>track) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> rank, <span class="at">group =</span> track)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>That’s greatly simplified creating the artist and track selection, but we have a new problem: the list of tracks isn’t synchronized with the selected artist. The default selected artist and track just happen to be a match, but if we select a track that wasn’t by the selected artist, we just get a blank plot.</p>
<p>Ideally, we’d like to update the available track choices based on the selected artist. We can do that by telling the server to look for changes in the selected artist, and then update the track selection input. This pattern is called an ‘observer’. The code for the user interface is identical (though we’ve changed the input/output id’s so they don’t conflict with the previous example).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">selectInput</span>(<span class="st">"artist_v2"</span>, <span class="st">"Choose an artist"</span>, billboard <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(artist))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="artist_v2-label" for="artist_v2">Choose an artist</label>
<div>
<select id="artist_v2" class="shiny-input-select"><optgroup label="artist">
<option value="2 Pac" selected="">2 Pac</option>
<option value="2Ge+her">2Ge+her</option>
<option value="3 Doors Down">3 Doors Down</option>
<option value="504 Boyz">504 Boyz</option>
<option value="98^0">98^0</option>
<option value="A*Teens">A*Teens</option>
<option value="Aaliyah">Aaliyah</option>
<option value="Adams, Yolanda">Adams, Yolanda</option>
<option value="Adkins, Trace">Adkins, Trace</option>
<option value="Aguilera, Christina">Aguilera, Christina</option>
<option value="Alice Deejay">Alice Deejay</option>
<option value="Allan, Gary">Allan, Gary</option>
<option value="Amber">Amber</option>
<option value="Anastacia">Anastacia</option>
<option value="Anthony, Marc">Anthony, Marc</option>
<option value="Avant">Avant</option>
<option value="BBMak">BBMak</option>
<option value="Backstreet Boys, The">Backstreet Boys, The</option>
<option value="Badu, Erkyah">Badu, Erkyah</option>
<option value="Baha Men">Baha Men</option>
<option value="Barenaked Ladies">Barenaked Ladies</option>
<option value="Beenie Man">Beenie Man</option>
<option value="Before Dark">Before Dark</option>
<option value="Bega, Lou">Bega, Lou</option>
<option value="Big Punisher">Big Punisher</option>
<option value="Black Rob">Black Rob</option>
<option value="Black, Clint">Black, Clint</option>
<option value="Blaque">Blaque</option>
<option value="Blige, Mary J.">Blige, Mary J.</option>
<option value="Blink-182">Blink-182</option>
<option value="Bloodhound Gang">Bloodhound Gang</option>
<option value="Bon Jovi">Bon Jovi</option>
<option value="Braxton, Toni">Braxton, Toni</option>
<option value="Brock, Chad">Brock, Chad</option>
<option value="Brooks &amp; Dunn">Brooks &amp; Dunn</option>
<option value="Brooks, Garth">Brooks, Garth</option>
<option value="Byrd, Tracy">Byrd, Tracy</option>
<option value="Cagle, Chris">Cagle, Chris</option>
<option value="Cam'ron">Cam'ron</option>
<option value="Carey, Mariah">Carey, Mariah</option>
<option value="Carter, Aaron">Carter, Aaron</option>
<option value="Carter, Torrey">Carter, Torrey</option>
<option value="Changing Faces">Changing Faces</option>
<option value="Chesney, Kenny">Chesney, Kenny</option>
<option value="Clark Family Experience">Clark Family Experience</option>
<option value="Clark, Terri">Clark, Terri</option>
<option value="Common">Common</option>
<option value="Counting Crows">Counting Crows</option>
<option value="Creed">Creed</option>
<option value="Cyrus, Billy Ray">Cyrus, Billy Ray</option>
<option value="D'Angelo">D'Angelo</option>
<option value="DMX">DMX</option>
<option value="Da Brat">Da Brat</option>
<option value="Davidson, Clay">Davidson, Clay</option>
<option value="De La Soul">De La Soul</option>
<option value="Destiny's Child">Destiny's Child</option>
<option value="Diffie, Joe">Diffie, Joe</option>
<option value="Dion, Celine">Dion, Celine</option>
<option value="Dixie Chicks, The">Dixie Chicks, The</option>
<option value="Dr. Dre">Dr. Dre</option>
<option value="Drama">Drama</option>
<option value="Dream">Dream</option>
<option value="Eastsidaz, The">Eastsidaz, The</option>
<option value="Eiffel 65">Eiffel 65</option>
<option value="Elliott, Missy &quot;Misdemeanor&quot;">Elliott, Missy "Misdemeanor"</option>
<option value="Eminem">Eminem</option>
<option value="En Vogue">En Vogue</option>
<option value="Estefan, Gloria">Estefan, Gloria</option>
<option value="Evans, Sara">Evans, Sara</option>
<option value="Eve">Eve</option>
<option value="Everclear">Everclear</option>
<option value="Fabian, Lara">Fabian, Lara</option>
<option value="Fatboy Slim">Fatboy Slim</option>
<option value="Filter">Filter</option>
<option value="Foo Fighters">Foo Fighters</option>
<option value="Fragma">Fragma</option>
<option value="Funkmaster Flex">Funkmaster Flex</option>
<option value="Ghostface Killah">Ghostface Killah</option>
<option value="Gill, Vince">Gill, Vince</option>
<option value="Gilman, Billy">Gilman, Billy</option>
<option value="Ginuwine">Ginuwine</option>
<option value="Goo Goo Dolls">Goo Goo Dolls</option>
<option value="Gray, Macy">Gray, Macy</option>
<option value="Griggs, Andy">Griggs, Andy</option>
<option value="Guy">Guy</option>
<option value="Hanson">Hanson</option>
<option value="Hart, Beth">Hart, Beth</option>
<option value="Heatherly, Eric">Heatherly, Eric</option>
<option value="Henley, Don">Henley, Don</option>
<option value="Herndon, Ty">Herndon, Ty</option>
<option value="Hill, Faith">Hill, Faith</option>
<option value="Hoku">Hoku</option>
<option value="Hollister, Dave">Hollister, Dave</option>
<option value="Hot Boys">Hot Boys</option>
<option value="Houston, Whitney">Houston, Whitney</option>
<option value="IMx">IMx</option>
<option value="Ice Cube">Ice Cube</option>
<option value="Ideal">Ideal</option>
<option value="Iglesias, Enrique">Iglesias, Enrique</option>
<option value="J-Shin">J-Shin</option>
<option value="Ja Rule">Ja Rule</option>
<option value="Jackson, Alan">Jackson, Alan</option>
<option value="Jagged Edge">Jagged Edge</option>
<option value="Janet">Janet</option>
<option value="Jay-Z">Jay-Z</option>
<option value="Jean, Wyclef">Jean, Wyclef</option>
<option value="Joe">Joe</option>
<option value="John, Elton">John, Elton</option>
<option value="Jones, Donell">Jones, Donell</option>
<option value="Jordan, Montell">Jordan, Montell</option>
<option value="Juvenile">Juvenile</option>
<option value="Kandi">Kandi</option>
<option value="Keith, Toby">Keith, Toby</option>
<option value="Kelis">Kelis</option>
<option value="Kenny G">Kenny G</option>
<option value="Kid Rock">Kid Rock</option>
<option value="Kravitz, Lenny">Kravitz, Lenny</option>
<option value="Kumbia Kings">Kumbia Kings</option>
<option value="LFO">LFO</option>
<option value="LL Cool J">LL Cool J</option>
<option value="Larrieux, Amel">Larrieux, Amel</option>
<option value="Lawrence, Tracy">Lawrence, Tracy</option>
<option value="Levert, Gerald">Levert, Gerald</option>
<option value="Lil Bow Wow">Lil Bow Wow</option>
<option value="Lil Wayne">Lil Wayne</option>
<option value="Lil' Kim">Lil' Kim</option>
<option value="Lil' Mo">Lil' Mo</option>
<option value="Lil' Zane">Lil' Zane</option>
<option value="Limp Bizkit">Limp Bizkit</option>
<option value="Lonestar">Lonestar</option>
<option value="Lopez, Jennifer">Lopez, Jennifer</option>
<option value="Loveless, Patty">Loveless, Patty</option>
<option value="Lox">Lox</option>
<option value="Lucy Pearl">Lucy Pearl</option>
<option value="Ludacris">Ludacris</option>
<option value="M2M">M2M</option>
<option value="Madison Avenue">Madison Avenue</option>
<option value="Madonna">Madonna</option>
<option value="Martin, Ricky">Martin, Ricky</option>
<option value="Mary Mary">Mary Mary</option>
<option value="Master P">Master P</option>
<option value="McBride, Martina">McBride, Martina</option>
<option value="McEntire, Reba">McEntire, Reba</option>
<option value="McGraw, Tim">McGraw, Tim</option>
<option value="McKnight, Brian">McKnight, Brian</option>
<option value="Messina, Jo Dee">Messina, Jo Dee</option>
<option value="Metallica">Metallica</option>
<option value="Montgomery Gentry">Montgomery Gentry</option>
<option value="Montgomery, John Michael">Montgomery, John Michael</option>
<option value="Moore, Chante">Moore, Chante</option>
<option value="Moore, Mandy">Moore, Mandy</option>
<option value="Mumba, Samantha">Mumba, Samantha</option>
<option value="Musiq">Musiq</option>
<option value="Mya">Mya</option>
<option value="Mystikal">Mystikal</option>
<option value="N'Sync">N'Sync</option>
<option value="Nas">Nas</option>
<option value="Nelly">Nelly</option>
<option value="Next">Next</option>
<option value="Nine Days">Nine Days</option>
<option value="No Doubt">No Doubt</option>
<option value="Nu Flavor">Nu Flavor</option>
<option value="Offspring, The">Offspring, The</option>
<option value="Paisley, Brad">Paisley, Brad</option>
<option value="Papa Roach">Papa Roach</option>
<option value="Pearl Jam">Pearl Jam</option>
<option value="Pink">Pink</option>
<option value="Price, Kelly">Price, Kelly</option>
<option value="Profyle">Profyle</option>
<option value="Puff Daddy">Puff Daddy</option>
<option value="Q-Tip">Q-Tip</option>
<option value="R.E.M.">R.E.M.</option>
<option value="Rascal Flatts">Rascal Flatts</option>
<option value="Raye, Collin">Raye, Collin</option>
<option value="Red Hot Chili Peppers">Red Hot Chili Peppers</option>
<option value="Rimes, LeAnn">Rimes, LeAnn</option>
<option value="Rogers, Kenny">Rogers, Kenny</option>
<option value="Ruff Endz">Ruff Endz</option>
<option value="Sammie">Sammie</option>
<option value="Santana">Santana</option>
<option value="Savage Garden">Savage Garden</option>
<option value="SheDaisy">SheDaisy</option>
<option value="Sheist, Shade">Sheist, Shade</option>
<option value="Shyne">Shyne</option>
<option value="Simpson, Jessica">Simpson, Jessica</option>
<option value="Sisqo">Sisqo</option>
<option value="Sister Hazel">Sister Hazel</option>
<option value="Smash Mouth">Smash Mouth</option>
<option value="Smith, Will">Smith, Will</option>
<option value="Son By Four">Son By Four</option>
<option value="Sonique">Sonique</option>
<option value="SoulDecision">SoulDecision</option>
<option value="Spears, Britney">Spears, Britney</option>
<option value="Spencer, Tracie">Spencer, Tracie</option>
<option value="Splender">Splender</option>
<option value="Sting">Sting</option>
<option value="Stone Temple Pilots">Stone Temple Pilots</option>
<option value="Stone, Angie">Stone, Angie</option>
<option value="Strait, George">Strait, George</option>
<option value="Sugar Ray">Sugar Ray</option>
<option value="TLC">TLC</option>
<option value="Tamar">Tamar</option>
<option value="Tamia">Tamia</option>
<option value="Third Eye Blind">Third Eye Blind</option>
<option value="Thomas, Carl">Thomas, Carl</option>
<option value="Tippin, Aaron">Tippin, Aaron</option>
<option value="Train">Train</option>
<option value="Trick Daddy">Trick Daddy</option>
<option value="Trina">Trina</option>
<option value="Tritt, Travis">Tritt, Travis</option>
<option value="Tuesday">Tuesday</option>
<option value="Urban, Keith">Urban, Keith</option>
<option value="Usher">Usher</option>
<option value="Vassar, Phil">Vassar, Phil</option>
<option value="Vertical Horizon">Vertical Horizon</option>
<option value="Vitamin C">Vitamin C</option>
<option value="Walker, Clay">Walker, Clay</option>
<option value="Wallflowers, The">Wallflowers, The</option>
<option value="Westlife">Westlife</option>
<option value="Williams, Robbie">Williams, Robbie</option>
<option value="Wills, Mark">Wills, Mark</option>
<option value="Worley, Darryl">Worley, Darryl</option>
<option value="Wright, Chely">Wright, Chely</option>
<option value="Yankee Grey">Yankee Grey</option>
<option value="Yearwood, Trisha">Yearwood, Trisha</option>
<option value="Ying Yang Twins">Ying Yang Twins</option>
<option value="Zombie Nation">Zombie Nation</option>
<option value="matchbox twenty">matchbox twenty</option>
</optgroup></select>
<script type="application/json" data-for="artist_v2" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">selectInput</span>(<span class="st">"track_v2"</span>, <span class="st">"Choose a track"</span>, billboard <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(track))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display no-overflow-x">
<div class="form-group shiny-input-container">
<label class="control-label" id="track_v2-label" for="track_v2">Choose a track</label>
<div>
<select id="track_v2" class="shiny-input-select"><optgroup label="track">
<option value="Baby Don't Cry (Keep..." selected="">Baby Don't Cry (Keep...</option>
<option value="The Hardest Part Of ...">The Hardest Part Of ...</option>
<option value="Kryptonite">Kryptonite</option>
<option value="Loser">Loser</option>
<option value="Wobble Wobble">Wobble Wobble</option>
<option value="Give Me Just One Nig...">Give Me Just One Nig...</option>
<option value="Dancing Queen">Dancing Queen</option>
<option value="I Don't Wanna">I Don't Wanna</option>
<option value="Try Again">Try Again</option>
<option value="Open My Heart">Open My Heart</option>
<option value="More">More</option>
<option value="Come On Over Baby (A...">Come On Over Baby (A...</option>
<option value="I Turn To You">I Turn To You</option>
<option value="What A Girl Wants">What A Girl Wants</option>
<option value="Better Off Alone">Better Off Alone</option>
<option value="Smoke Rings In The D...">Smoke Rings In The D...</option>
<option value="Sexual">Sexual</option>
<option value="I'm Outta Love">I'm Outta Love</option>
<option value="My Baby You">My Baby You</option>
<option value="You Sang To Me">You Sang To Me</option>
<option value="My First Love">My First Love</option>
<option value="Separated">Separated</option>
<option value="Back Here">Back Here</option>
<option value="Shape Of My Heart">Shape Of My Heart</option>
<option value="Show Me The Meaning ...">Show Me The Meaning ...</option>
<option value="The One">The One</option>
<option value="Bag Lady">Bag Lady</option>
<option value="Who Let The Dogs Out">Who Let The Dogs Out</option>
<option value="Pinch Me">Pinch Me</option>
<option value="Girls Dem Sugar">Girls Dem Sugar</option>
<option value="Monica">Monica</option>
<option value="Tricky Tricky">Tricky Tricky</option>
<option value="It's So Hard">It's So Hard</option>
<option value="Whoa!">Whoa!</option>
<option value="Been There">Been There</option>
<option value="Bring It All To Me">Bring It All To Me</option>
<option value="Deep Inside">Deep Inside</option>
<option value="Give Me You">Give Me You</option>
<option value="All The Small Things">All The Small Things</option>
<option value="The Bad Touch">The Bad Touch</option>
<option value="It's My Life">It's My Life</option>
<option value="He Wasn't Man Enough">He Wasn't Man Enough</option>
<option value="Just Be A Man About ...">Just Be A Man About ...</option>
<option value="Spanish Guitar">Spanish Guitar</option>
<option value="A Country Boy Can Su...">A Country Boy Can Su...</option>
<option value="Yes!">Yes!</option>
<option value="You'll Always Be Lov...">You'll Always Be Lov...</option>
<option value="Do What You Gotta Do">Do What You Gotta Do</option>
<option value="Put Your Hand In Min...">Put Your Hand In Min...</option>
<option value="My Love Goes On And ...">My Love Goes On And ...</option>
<option value="What Means The World...">What Means The World...</option>
<option value="Crybaby">Crybaby</option>
<option value="Thank God I Found Yo...">Thank God I Found Yo...</option>
<option value="Aaron's Party (Come ...">Aaron's Party (Come ...</option>
<option value="Take That">Take That</option>
<option value="That Other Woman">That Other Woman</option>
<option value="I Lost It">I Lost It</option>
<option value="What I Need To Do">What I Need To Do</option>
<option value="Meanwhile Back At Th...">Meanwhile Back At Th...</option>
<option value="A Little Gasoline">A Little Gasoline</option>
<option value="The Light">The Light</option>
<option value="Hanginaround">Hanginaround</option>
<option value="Higher">Higher</option>
<option value="With Arms Wide Open">With Arms Wide Open</option>
<option value="You Won't Be Lonely ...">You Won't Be Lonely ...</option>
<option value="Left &amp; Right">Left &amp; Right</option>
<option value="Untitled (How Does I...">Untitled (How Does I...</option>
<option value="Party Up (Up In Here...">Party Up (Up In Here...</option>
<option value="What You Want">What You Want</option>
<option value="What's My Name">What's My Name</option>
<option value="That's What I'm Look...">That's What I'm Look...</option>
<option value="What'Chu Like">What'Chu Like</option>
<option value="Unconditional">Unconditional</option>
<option value="All Good?">All Good?</option>
<option value="Independent Women Pa...">Independent Women Pa...</option>
<option value="Jumpin' Jumpin'">Jumpin' Jumpin'</option>
<option value="Say My Name">Say My Name</option>
<option value="It's Always Somethin...">It's Always Somethin...</option>
<option value="The Quittin' Kind">The Quittin' Kind</option>
<option value="That's The Way It Is">That's The Way It Is</option>
<option value="Cold Day In July">Cold Day In July</option>
<option value="Cowboy Take Me Away">Cowboy Take Me Away</option>
<option value="Goodbye Earl">Goodbye Earl</option>
<option value="Without You">Without You</option>
<option value="Forgot About Dre">Forgot About Dre</option>
<option value="The Next Episode">The Next Episode</option>
<option value="Left, Right, Left">Left, Right, Left</option>
<option value="He Loves U Not">He Loves U Not</option>
<option value="G'D Up">G'D Up</option>
<option value="Got Beef">Got Beef</option>
<option value="Blue">Blue</option>
<option value="Hot Boyz">Hot Boyz</option>
<option value="Stan">Stan</option>
<option value="The Real Slim Shady">The Real Slim Shady</option>
<option value="The Way I Am">The Way I Am</option>
<option value="Riddle">Riddle</option>
<option value="No Me Dejes De Quere...">No Me Dejes De Quere...</option>
<option value="Born To Fly">Born To Fly</option>
<option value="Got It All">Got It All</option>
<option value="Love Is Blind">Love Is Blind</option>
<option value="Wonderful">Wonderful</option>
<option value="I Will Love Again">I Will Love Again</option>
<option value="The Rockafeller Skan...">The Rockafeller Skan...</option>
<option value="Take A Picture">Take A Picture</option>
<option value="Learn To Fly">Learn To Fly</option>
<option value="Toca's Miracle">Toca's Miracle</option>
<option value="Do You">Do You</option>
<option value="Cherchez LaGhost">Cherchez LaGhost</option>
<option value="Feels Like Love">Feels Like Love</option>
<option value="One Voice">One Voice</option>
<option value="None Of Ur Friends B...">None Of Ur Friends B...</option>
<option value="The Best Man I Can B...">The Best Man I Can B...</option>
<option value="Broadway">Broadway</option>
<option value="I Try">I Try</option>
<option value="She's More">She's More</option>
<option value="Dancin'">Dancin'</option>
<option value="This Time Around">This Time Around</option>
<option value="L.A. Song">L.A. Song</option>
<option value="Flowers On The Wall">Flowers On The Wall</option>
<option value="Taking You Home">Taking You Home</option>
<option value="No Mercy">No Mercy</option>
<option value="Breathe">Breathe</option>
<option value="Let's Make Love">Let's Make Love</option>
<option value="Another Dumb Blonde">Another Dumb Blonde</option>
<option value="Can't Stay">Can't Stay</option>
<option value="I Need A Hot Girl">I Need A Hot Girl</option>
<option value="Could I Have This Ki...">Could I Have This Ki...</option>
<option value="I Learned From The B...">I Learned From The B...</option>
<option value="My Love Is Your Love">My Love Is Your Love</option>
<option value="Same Script, Differe...">Same Script, Differe...</option>
<option value="Stay The Night">Stay The Night</option>
<option value="You Can Do It">You Can Do It</option>
<option value="Whatever">Whatever</option>
<option value="Be With You">Be With You</option>
<option value="Rhythm Divine">Rhythm Divine</option>
<option value="One Night Stand">One Night Stand</option>
<option value="Between Me And You">Between Me And You</option>
<option value="It Must Be Love">It Must Be Love</option>
<option value="Pop A Top">Pop A Top</option>
<option value="www.memory">www.memory</option>
<option value="He Can't Love U">He Can't Love U</option>
<option value="Let's Get Married">Let's Get Married</option>
<option value="Doesn't Really Matte...">Doesn't Really Matte...</option>
<option value="Anything">Anything</option>
<option value="Big Pimpin'">Big Pimpin'</option>
<option value="Do It Again (Put Ya ...">Do It Again (Put Ya ...</option>
<option value="Hey Papi">Hey Papi</option>
<option value="I Just Wanna Love U ...">I Just Wanna Love U ...</option>
<option value="911">911</option>
<option value="I Wanna Know">I Wanna Know</option>
<option value="Treat Her Like A Lad...">Treat Her Like A Lad...</option>
<option value="Someday Out Of The B...">Someday Out Of The B...</option>
<option value="Where I Wanna Be">Where I Wanna Be</option>
<option value="Get It On.. Tonite">Get It On.. Tonite</option>
<option value="U Understand">U Understand</option>
<option value="Don't Think I'm Not">Don't Think I'm Not</option>
<option value="Country Comes To Tow...">Country Comes To Tow...</option>
<option value="How Do You Like Me N...">How Do You Like Me N...</option>
<option value="Caught Out There">Caught Out There</option>
<option value="Auld Lang Syne (The ...">Auld Lang Syne (The ...</option>
<option value="Only God Knows Why">Only God Knows Why</option>
<option value="I Belong To You">I Belong To You</option>
<option value="U Don't Love Me">U Don't Love Me</option>
<option value="I Don't Wanna Kiss Y...">I Don't Wanna Kiss Y...</option>
<option value="West Side Story">West Side Story</option>
<option value="Imagine That">Imagine That</option>
<option value="Get Up">Get Up</option>
<option value="Lessons Learned">Lessons Learned</option>
<option value="Baby U Are">Baby U Are</option>
<option value="Mr. Too Damn Good">Mr. Too Damn Good</option>
<option value="Bounce With Me">Bounce With Me</option>
<option value="Tha Block Is Hot">Tha Block Is Hot</option>
<option value="How Many Licks?">How Many Licks?</option>
<option value="No Matter What They ...">No Matter What They ...</option>
<option value="Ta Da">Ta Da</option>
<option value="Callin' Me">Callin' Me</option>
<option value="N 2 Gether Now">N 2 Gether Now</option>
<option value="Re-Arranged">Re-Arranged</option>
<option value="Rollin'">Rollin'</option>
<option value="Amazed">Amazed</option>
<option value="Smile">Smile</option>
<option value="What About Now">What About Now</option>
<option value="Feelin' Good">Feelin' Good</option>
<option value="That's The Kind Of M...">That's The Kind Of M...</option>
<option value="Ryde or Die, Chick">Ryde or Die, Chick</option>
<option value="Dance Tonight">Dance Tonight</option>
<option value="What's Your Fantasy">What's Your Fantasy</option>
<option value="Don't Say You Love M...">Don't Say You Love M...</option>
<option value="Mirror Mirror">Mirror Mirror</option>
<option value="Don't Call Me Baby">Don't Call Me Baby</option>
<option value="American Pie">American Pie</option>
<option value="Music">Music</option>
<option value="Private Emotion">Private Emotion</option>
<option value="Shake Your Bon-Bon">Shake Your Bon-Bon</option>
<option value="She Bangs">She Bangs</option>
<option value="Shackles (Praise You...">Shackles (Praise You...</option>
<option value="Souljas">Souljas</option>
<option value="Love's The Only Hous...">Love's The Only Hous...</option>
<option value="There You Are">There You Are</option>
<option value="I'll Be">I'll Be</option>
<option value="What Do You Say">What Do You Say</option>
<option value="My Best Friend">My Best Friend</option>
<option value="My Next Thirty Years">My Next Thirty Years</option>
<option value="Some Things Never Ch...">Some Things Never Ch...</option>
<option value="Stay Or Let It Go">Stay Or Let It Go</option>
<option value="Because You Love Me">Because You Love Me</option>
<option value="That's The Way">That's The Way</option>
<option value="I Disappear">I Disappear</option>
<option value="No Leaf Clover (Live...">No Leaf Clover (Live...</option>
<option value="Daddy Won't Sell The...">Daddy Won't Sell The...</option>
<option value="The Little Girl">The Little Girl</option>
<option value="Straight Up">Straight Up</option>
<option value="I Wanna Be With You">I Wanna Be With You</option>
<option value="Gotta Tell You">Gotta Tell You</option>
<option value="Just Friends">Just Friends</option>
<option value="Case Of The Ex (What...">Case Of The Ex (What...</option>
<option value="The Best Of Me">The Best Of Me</option>
<option value="Shake Ya Ass">Shake Ya Ass</option>
<option value="Bye Bye Bye">Bye Bye Bye</option>
<option value="It's Gonna Be Me">It's Gonna Be Me</option>
<option value="This I Promise You">This I Promise You</option>
<option value="You Owe Me">You Owe Me</option>
<option value="(Hot S**t) Country G...">(Hot S**t) Country G...</option>
<option value="Wifey">Wifey</option>
<option value="Absolutely (Story Of...">Absolutely (Story Of...</option>
<option value="If I Am">If I Am</option>
<option value="Simple Kind Of Life">Simple Kind Of Life</option>
<option value="3 Little Words">3 Little Words</option>
<option value="Original Prankster">Original Prankster</option>
<option value="Me Neither">Me Neither</option>
<option value="We Danced">We Danced</option>
<option value="Last Resort">Last Resort</option>
<option value="Nothing As It Seems">Nothing As It Seems</option>
<option value="Most Girls">Most Girls</option>
<option value="There U Go">There U Go</option>
<option value="As We Lay">As We Lay</option>
<option value="Love Sets You Free">Love Sets You Free</option>
<option value="You Should've Told M...">You Should've Told M...</option>
<option value="Liar">Liar</option>
<option value="Best Friend">Best Friend</option>
<option value="Breathe And Stop">Breathe And Stop</option>
<option value="The Great Beyond">The Great Beyond</option>
<option value="Prayin' For Daylight">Prayin' For Daylight</option>
<option value="Couldn't Last A Mome...">Couldn't Last A Mome...</option>
<option value="Californication">Californication</option>
<option value="Otherside">Otherside</option>
<option value="Big Deal">Big Deal</option>
<option value="Can't Fight The Moon...">Can't Fight The Moon...</option>
<option value="I Need You">I Need You</option>
<option value="Buy Me A Rose">Buy Me A Rose</option>
<option value="No More">No More</option>
<option value="I Like It">I Like It</option>
<option value="Maria, Maria">Maria, Maria</option>
<option value="Crash And Burn">Crash And Burn</option>
<option value="I Knew I Loved You">I Knew I Loved You</option>
<option value="Deck The Halls">Deck The Halls</option>
<option value="I Will.. But">I Will.. But</option>
<option value="This Woman Needs">This Woman Needs</option>
<option value="Bad Boyz">Bad Boyz</option>
<option value="I Think I'm In Love ...">I Think I'm In Love ...</option>
<option value="Where You Are">Where You Are</option>
<option value="Got To Get It">Got To Get It</option>
<option value="Incomplete">Incomplete</option>
<option value="Thong Song">Thong Song</option>
<option value="Change Your Mind">Change Your Mind</option>
<option value="Then The Morning Com...">Then The Morning Com...</option>
<option value="Freakin' It">Freakin' It</option>
<option value="A Puro Dolor (Purest...">A Puro Dolor (Purest...</option>
<option value="It Feels So Good">It Feels So Good</option>
<option value="Faded">Faded</option>
<option value="From The Bottom Of M...">From The Bottom Of M...</option>
<option value="Lucky">Lucky</option>
<option value="Oops!.. I Did It Aga...">Oops!.. I Did It Aga...</option>
<option value="Still In My Heart">Still In My Heart</option>
<option value="I Think God Can Expl...">I Think God Can Expl...</option>
<option value="Desert Rose">Desert Rose</option>
<option value="Sour Girl">Sour Girl</option>
<option value="No More Rain (In Thi...">No More Rain (In Thi...</option>
<option value="Go On">Go On</option>
<option value="The Best Day">The Best Day</option>
<option value="Falls Apart">Falls Apart</option>
<option value="Dear Lie">Dear Lie</option>
<option value="If You Don't Wanna L...">If You Don't Wanna L...</option>
<option value="Can't Go For That">Can't Go For That</option>
<option value="Deep Inside Of You">Deep Inside Of You</option>
<option value="Never Let You Go">Never Let You Go</option>
<option value="Emotional">Emotional</option>
<option value="I Wish">I Wish</option>
<option value="Summer Rain">Summer Rain</option>
<option value="Kiss This">Kiss This</option>
<option value="Meet Virginia">Meet Virginia</option>
<option value="Shut Up">Shut Up</option>
<option value="Pull Over">Pull Over</option>
<option value="Best Of Intentions">Best Of Intentions</option>
<option value="I Know">I Know</option>
<option value="Your Everything">Your Everything</option>
<option value="Pop Ya Collar">Pop Ya Collar</option>
<option value="Carlene">Carlene</option>
<option value="Just Another Day In ...">Just Another Day In ...</option>
<option value="Everything You Want">Everything You Want</option>
<option value="You're A God">You're A God</option>
<option value="Graduation (Friends ...">Graduation (Friends ...</option>
<option value="The Itch">The Itch</option>
<option value="Live, Laugh, Love">Live, Laugh, Love</option>
<option value="The Chain Of Love">The Chain Of Love</option>
<option value="Sleepwalker">Sleepwalker</option>
<option value="Swear It Again">Swear It Again</option>
<option value="Angels">Angels</option>
<option value="Back At One">Back At One</option>
<option value="When You Need My Lov...">When You Need My Lov...</option>
<option value="It Was">It Was</option>
<option value="Another Nine Minutes">Another Nine Minutes</option>
<option value="Real Live Woman">Real Live Woman</option>
<option value="Whistle While You Tw...">Whistle While You Tw...</option>
<option value="Kernkraft 400">Kernkraft 400</option>
<option value="Bent">Bent</option>
</optgroup></select>
<script type="application/json" data-for="track_v2" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotOutput</span>(<span class="st">"track_performance_v2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="shiny-plot-output html-fill-item" id="track_performance_v2" style="width:100%;height:400px;"></div>
</div>
</div>
<p>On the server side, we’ve added an observer to watch for changes in the selected artist, and update the list of tracks when needed. The code for the graphs is identical to the previous example (with the exception, again, of new id’s).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an 'observer' that triggers an action when it's inputs change.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note that the name we give this observer is irrelevant, but I like to use </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># descriptive names following a "on_&lt;subject&gt;_&lt;verb&gt;" template.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>on_artist_change <span class="ot">&lt;-</span> <span class="fu">observe</span>({</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateSelectInput</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    session,      <span class="co"># 'session' is an optional argument to the 'server(...)`</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># function, and contains information on the client the server is</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># talking to - as the server can have multiple users each with </span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># their own 'copy' of the app at the same time.</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"track_v2"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">choices =</span> billboard <span class="sc">%&gt;%</span>                   <span class="co"># we update the available track choices </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(artist <span class="sc">==</span> input<span class="sc">$</span>artist_v2) <span class="sc">%&gt;%</span>   <span class="co"># by filtering by the selected artist.</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(track) <span class="sc">%&gt;%</span>                         <span class="co"># Note that the selected track will auto-</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unique</span>()                                <span class="co"># change, as whatever track was previously</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  )                                           <span class="co"># selected will now no longer be valid. </span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>track_performance_v2 <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter data with user choices</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  billboard_long <span class="sc">%&gt;%</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(artist <span class="sc">==</span> input<span class="sc">$</span>artist_v2, track <span class="sc">==</span> input<span class="sc">$</span>track_v2) <span class="sc">%&gt;%</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> rank, <span class="at">group =</span> track)) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, whenever the artist changes, the list of tracks we can choose from changes with it.</p>
</section>
<section id="dynamic-ui" class="level2">
<h2 class="anchored" data-anchor-id="dynamic-ui">dynamic UI</h2>
<p>In the previous section, we updated the available choices for a ui element, but the basic UI elements stayed the same. But what if we want to add, remove, or change inputs or other UI elements dynamically? For example, what if for artists with only one track in the billboard data, we want to hide the track choice dropdown, and display only the track name instead?</p>
<p>This is a simplified example, but we can accomplish this - and much, much more - using the <code>uiOutput</code> and <code>renderUI</code> functions. These functions allow us to define and update UI elements on the server, and use them as inputs just as if they were defined in the UI.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># !! We had to wrap inputs in a 'div' element to avoid quarto creating a separate</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cell container # for each input/output and screwing up overflow on the dropdown </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># element(s). The extra div isn't necessary in a regular shiny app.</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">div</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">selectInput</span>(<span class="st">"artist_v3"</span>, <span class="st">"Choose an artist"</span>, billboard <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(artist)),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uiOutput</span>(<span class="st">"track_v3_ui"</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotOutput</span>(<span class="st">"track_performance_v3"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display no-overflow-x">
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="artist_v3-label" for="artist_v3">Choose an artist</label>
<div>
<select id="artist_v3" class="shiny-input-select"><optgroup label="artist">
<option value="2 Pac" selected="">2 Pac</option>
<option value="2Ge+her">2Ge+her</option>
<option value="3 Doors Down">3 Doors Down</option>
<option value="504 Boyz">504 Boyz</option>
<option value="98^0">98^0</option>
<option value="A*Teens">A*Teens</option>
<option value="Aaliyah">Aaliyah</option>
<option value="Adams, Yolanda">Adams, Yolanda</option>
<option value="Adkins, Trace">Adkins, Trace</option>
<option value="Aguilera, Christina">Aguilera, Christina</option>
<option value="Alice Deejay">Alice Deejay</option>
<option value="Allan, Gary">Allan, Gary</option>
<option value="Amber">Amber</option>
<option value="Anastacia">Anastacia</option>
<option value="Anthony, Marc">Anthony, Marc</option>
<option value="Avant">Avant</option>
<option value="BBMak">BBMak</option>
<option value="Backstreet Boys, The">Backstreet Boys, The</option>
<option value="Badu, Erkyah">Badu, Erkyah</option>
<option value="Baha Men">Baha Men</option>
<option value="Barenaked Ladies">Barenaked Ladies</option>
<option value="Beenie Man">Beenie Man</option>
<option value="Before Dark">Before Dark</option>
<option value="Bega, Lou">Bega, Lou</option>
<option value="Big Punisher">Big Punisher</option>
<option value="Black Rob">Black Rob</option>
<option value="Black, Clint">Black, Clint</option>
<option value="Blaque">Blaque</option>
<option value="Blige, Mary J.">Blige, Mary J.</option>
<option value="Blink-182">Blink-182</option>
<option value="Bloodhound Gang">Bloodhound Gang</option>
<option value="Bon Jovi">Bon Jovi</option>
<option value="Braxton, Toni">Braxton, Toni</option>
<option value="Brock, Chad">Brock, Chad</option>
<option value="Brooks &amp; Dunn">Brooks &amp; Dunn</option>
<option value="Brooks, Garth">Brooks, Garth</option>
<option value="Byrd, Tracy">Byrd, Tracy</option>
<option value="Cagle, Chris">Cagle, Chris</option>
<option value="Cam'ron">Cam'ron</option>
<option value="Carey, Mariah">Carey, Mariah</option>
<option value="Carter, Aaron">Carter, Aaron</option>
<option value="Carter, Torrey">Carter, Torrey</option>
<option value="Changing Faces">Changing Faces</option>
<option value="Chesney, Kenny">Chesney, Kenny</option>
<option value="Clark Family Experience">Clark Family Experience</option>
<option value="Clark, Terri">Clark, Terri</option>
<option value="Common">Common</option>
<option value="Counting Crows">Counting Crows</option>
<option value="Creed">Creed</option>
<option value="Cyrus, Billy Ray">Cyrus, Billy Ray</option>
<option value="D'Angelo">D'Angelo</option>
<option value="DMX">DMX</option>
<option value="Da Brat">Da Brat</option>
<option value="Davidson, Clay">Davidson, Clay</option>
<option value="De La Soul">De La Soul</option>
<option value="Destiny's Child">Destiny's Child</option>
<option value="Diffie, Joe">Diffie, Joe</option>
<option value="Dion, Celine">Dion, Celine</option>
<option value="Dixie Chicks, The">Dixie Chicks, The</option>
<option value="Dr. Dre">Dr. Dre</option>
<option value="Drama">Drama</option>
<option value="Dream">Dream</option>
<option value="Eastsidaz, The">Eastsidaz, The</option>
<option value="Eiffel 65">Eiffel 65</option>
<option value="Elliott, Missy &quot;Misdemeanor&quot;">Elliott, Missy "Misdemeanor"</option>
<option value="Eminem">Eminem</option>
<option value="En Vogue">En Vogue</option>
<option value="Estefan, Gloria">Estefan, Gloria</option>
<option value="Evans, Sara">Evans, Sara</option>
<option value="Eve">Eve</option>
<option value="Everclear">Everclear</option>
<option value="Fabian, Lara">Fabian, Lara</option>
<option value="Fatboy Slim">Fatboy Slim</option>
<option value="Filter">Filter</option>
<option value="Foo Fighters">Foo Fighters</option>
<option value="Fragma">Fragma</option>
<option value="Funkmaster Flex">Funkmaster Flex</option>
<option value="Ghostface Killah">Ghostface Killah</option>
<option value="Gill, Vince">Gill, Vince</option>
<option value="Gilman, Billy">Gilman, Billy</option>
<option value="Ginuwine">Ginuwine</option>
<option value="Goo Goo Dolls">Goo Goo Dolls</option>
<option value="Gray, Macy">Gray, Macy</option>
<option value="Griggs, Andy">Griggs, Andy</option>
<option value="Guy">Guy</option>
<option value="Hanson">Hanson</option>
<option value="Hart, Beth">Hart, Beth</option>
<option value="Heatherly, Eric">Heatherly, Eric</option>
<option value="Henley, Don">Henley, Don</option>
<option value="Herndon, Ty">Herndon, Ty</option>
<option value="Hill, Faith">Hill, Faith</option>
<option value="Hoku">Hoku</option>
<option value="Hollister, Dave">Hollister, Dave</option>
<option value="Hot Boys">Hot Boys</option>
<option value="Houston, Whitney">Houston, Whitney</option>
<option value="IMx">IMx</option>
<option value="Ice Cube">Ice Cube</option>
<option value="Ideal">Ideal</option>
<option value="Iglesias, Enrique">Iglesias, Enrique</option>
<option value="J-Shin">J-Shin</option>
<option value="Ja Rule">Ja Rule</option>
<option value="Jackson, Alan">Jackson, Alan</option>
<option value="Jagged Edge">Jagged Edge</option>
<option value="Janet">Janet</option>
<option value="Jay-Z">Jay-Z</option>
<option value="Jean, Wyclef">Jean, Wyclef</option>
<option value="Joe">Joe</option>
<option value="John, Elton">John, Elton</option>
<option value="Jones, Donell">Jones, Donell</option>
<option value="Jordan, Montell">Jordan, Montell</option>
<option value="Juvenile">Juvenile</option>
<option value="Kandi">Kandi</option>
<option value="Keith, Toby">Keith, Toby</option>
<option value="Kelis">Kelis</option>
<option value="Kenny G">Kenny G</option>
<option value="Kid Rock">Kid Rock</option>
<option value="Kravitz, Lenny">Kravitz, Lenny</option>
<option value="Kumbia Kings">Kumbia Kings</option>
<option value="LFO">LFO</option>
<option value="LL Cool J">LL Cool J</option>
<option value="Larrieux, Amel">Larrieux, Amel</option>
<option value="Lawrence, Tracy">Lawrence, Tracy</option>
<option value="Levert, Gerald">Levert, Gerald</option>
<option value="Lil Bow Wow">Lil Bow Wow</option>
<option value="Lil Wayne">Lil Wayne</option>
<option value="Lil' Kim">Lil' Kim</option>
<option value="Lil' Mo">Lil' Mo</option>
<option value="Lil' Zane">Lil' Zane</option>
<option value="Limp Bizkit">Limp Bizkit</option>
<option value="Lonestar">Lonestar</option>
<option value="Lopez, Jennifer">Lopez, Jennifer</option>
<option value="Loveless, Patty">Loveless, Patty</option>
<option value="Lox">Lox</option>
<option value="Lucy Pearl">Lucy Pearl</option>
<option value="Ludacris">Ludacris</option>
<option value="M2M">M2M</option>
<option value="Madison Avenue">Madison Avenue</option>
<option value="Madonna">Madonna</option>
<option value="Martin, Ricky">Martin, Ricky</option>
<option value="Mary Mary">Mary Mary</option>
<option value="Master P">Master P</option>
<option value="McBride, Martina">McBride, Martina</option>
<option value="McEntire, Reba">McEntire, Reba</option>
<option value="McGraw, Tim">McGraw, Tim</option>
<option value="McKnight, Brian">McKnight, Brian</option>
<option value="Messina, Jo Dee">Messina, Jo Dee</option>
<option value="Metallica">Metallica</option>
<option value="Montgomery Gentry">Montgomery Gentry</option>
<option value="Montgomery, John Michael">Montgomery, John Michael</option>
<option value="Moore, Chante">Moore, Chante</option>
<option value="Moore, Mandy">Moore, Mandy</option>
<option value="Mumba, Samantha">Mumba, Samantha</option>
<option value="Musiq">Musiq</option>
<option value="Mya">Mya</option>
<option value="Mystikal">Mystikal</option>
<option value="N'Sync">N'Sync</option>
<option value="Nas">Nas</option>
<option value="Nelly">Nelly</option>
<option value="Next">Next</option>
<option value="Nine Days">Nine Days</option>
<option value="No Doubt">No Doubt</option>
<option value="Nu Flavor">Nu Flavor</option>
<option value="Offspring, The">Offspring, The</option>
<option value="Paisley, Brad">Paisley, Brad</option>
<option value="Papa Roach">Papa Roach</option>
<option value="Pearl Jam">Pearl Jam</option>
<option value="Pink">Pink</option>
<option value="Price, Kelly">Price, Kelly</option>
<option value="Profyle">Profyle</option>
<option value="Puff Daddy">Puff Daddy</option>
<option value="Q-Tip">Q-Tip</option>
<option value="R.E.M.">R.E.M.</option>
<option value="Rascal Flatts">Rascal Flatts</option>
<option value="Raye, Collin">Raye, Collin</option>
<option value="Red Hot Chili Peppers">Red Hot Chili Peppers</option>
<option value="Rimes, LeAnn">Rimes, LeAnn</option>
<option value="Rogers, Kenny">Rogers, Kenny</option>
<option value="Ruff Endz">Ruff Endz</option>
<option value="Sammie">Sammie</option>
<option value="Santana">Santana</option>
<option value="Savage Garden">Savage Garden</option>
<option value="SheDaisy">SheDaisy</option>
<option value="Sheist, Shade">Sheist, Shade</option>
<option value="Shyne">Shyne</option>
<option value="Simpson, Jessica">Simpson, Jessica</option>
<option value="Sisqo">Sisqo</option>
<option value="Sister Hazel">Sister Hazel</option>
<option value="Smash Mouth">Smash Mouth</option>
<option value="Smith, Will">Smith, Will</option>
<option value="Son By Four">Son By Four</option>
<option value="Sonique">Sonique</option>
<option value="SoulDecision">SoulDecision</option>
<option value="Spears, Britney">Spears, Britney</option>
<option value="Spencer, Tracie">Spencer, Tracie</option>
<option value="Splender">Splender</option>
<option value="Sting">Sting</option>
<option value="Stone Temple Pilots">Stone Temple Pilots</option>
<option value="Stone, Angie">Stone, Angie</option>
<option value="Strait, George">Strait, George</option>
<option value="Sugar Ray">Sugar Ray</option>
<option value="TLC">TLC</option>
<option value="Tamar">Tamar</option>
<option value="Tamia">Tamia</option>
<option value="Third Eye Blind">Third Eye Blind</option>
<option value="Thomas, Carl">Thomas, Carl</option>
<option value="Tippin, Aaron">Tippin, Aaron</option>
<option value="Train">Train</option>
<option value="Trick Daddy">Trick Daddy</option>
<option value="Trina">Trina</option>
<option value="Tritt, Travis">Tritt, Travis</option>
<option value="Tuesday">Tuesday</option>
<option value="Urban, Keith">Urban, Keith</option>
<option value="Usher">Usher</option>
<option value="Vassar, Phil">Vassar, Phil</option>
<option value="Vertical Horizon">Vertical Horizon</option>
<option value="Vitamin C">Vitamin C</option>
<option value="Walker, Clay">Walker, Clay</option>
<option value="Wallflowers, The">Wallflowers, The</option>
<option value="Westlife">Westlife</option>
<option value="Williams, Robbie">Williams, Robbie</option>
<option value="Wills, Mark">Wills, Mark</option>
<option value="Worley, Darryl">Worley, Darryl</option>
<option value="Wright, Chely">Wright, Chely</option>
<option value="Yankee Grey">Yankee Grey</option>
<option value="Yearwood, Trisha">Yearwood, Trisha</option>
<option value="Ying Yang Twins">Ying Yang Twins</option>
<option value="Zombie Nation">Zombie Nation</option>
<option value="matchbox twenty">matchbox twenty</option>
</optgroup></select>
<script type="application/json" data-for="artist_v3" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
<div id="track_v3_ui" class="shiny-html-output"></div>
<div class="shiny-plot-output html-fill-item" id="track_performance_v3" style="width:100%;height:400px;"></div>
</div>
</div>
</div>
<p>While the UI is very similar, the server-side code is considerably more complex. Because we’ve meddled with the default flow of operations, we now have to manually handle some edge cases. For example, because we’re hiding the track selection dropdown for artists with only one track in the billboards data, the selected track isn’t automatically updated when a new artist is selected. This logic is handled with a reactive value and two observers at the top of the server code:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a 'reactive' object that we can use to manually trigger track selection changes</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>selected_track <span class="ot">&lt;-</span> <span class="fu">reactiveVal</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># if a track is manually chosen, update the selected track.</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>on_track_changed <span class="ot">&lt;-</span> <span class="fu">observe</span>({</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">selected_track</span>(input<span class="sc">$</span>track_v3)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># if the chosen artist changes, and only one track is available, set it as selected</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># note that is there are multiple choices, we don't have to change the selected track,</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the selectInput widget will trigger a change event for us, and the `on_track_changed`</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># observer we defined above will update the selected track.</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>on_artist_changed <span class="ot">&lt;-</span> <span class="fu">observe</span>({</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  .tracks <span class="ot">&lt;-</span> billboard <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(artist <span class="sc">==</span> input<span class="sc">$</span>artist_v3) <span class="sc">%&gt;%</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(track) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(.tracks) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selected_track</span>(.tracks[<span class="dv">1</span>])</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The UI for track selection is either the <code>selectInput</code> function we’ve used before, or a non-interactive label created with ‘plain’ HTML elements.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>track_v3_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req</span>(input<span class="sc">$</span>artist_v3)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  .tracks <span class="ot">&lt;-</span> billboard <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(artist <span class="sc">==</span> input<span class="sc">$</span>artist_v3) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(track) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(.tracks) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If there's only one option, show a non-interactive text element with the </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># track name</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># shiny provides 'wrapper' functions to create basic html elements. In this </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># case, we use a div containing a label (less common or conflicting html tags</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># are accessible through the `tags` list) and a paragraph (`p`) element.</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># The paragraph has a grey text colour to visually clue the user in (even more)</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># that this value cannot be changed (it is 'disabled').</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For more info on html elements or css styling, see your favourite search engine.</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">div</span>(</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">label</span>(<span class="st">"Selected track:"</span>),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>(.tracks, <span class="at">style =</span> <span class="st">"color: darkgrey;"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if we have multiple choices, we use the selectInput shiny widget. </span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note that the input we return is essentially identical to the input we </span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># used in the UI in the previous examples.</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">selectInput</span>(<span class="st">"track_v3"</span>, <span class="at">label =</span> <span class="st">"Choose a track..."</span>, <span class="at">choices =</span> .tracks))</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Finally, the plot output is almost identical, but we now use the reactive value for the selected track, rather than the user input directly.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>track_performance_v3 <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only continue when a track is selected.</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">req</span>(<span class="fu">selected_track</span>())</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  billboard_long <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(artist <span class="sc">==</span> input<span class="sc">$</span>artist_v3, track <span class="sc">==</span> <span class="fu">selected_track</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> rank, <span class="at">group =</span> track)) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The possibilities for nesting UI components are endless. Note however that with each additional layer of dynamism in the UI, the code gets exponentially more complex. In such cases, <em>modules</em> might be more appropriate, but that is out of scope here. The previous example</p>
<p>
<script type="application/shiny-prerendered" data-context="server-start">

library(shiny)
library(tidyverse)

</script>
 
<script type="application/shiny-prerendered" data-context="data">
# example dataset
data("billboard")

# The billboard dataset is a textbook example of a 'wide' dataset, we use
# the example code from the `pivot_wider(...)` function to create a 'long'
# dataset containing one row for each track, for each week that it listed
# in the charts.
billboard_long <- billboard %>%
  pivot_longer(
    cols = starts_with("wk"),
    names_to = "week",
    names_prefix = "wk",
    values_to = "rank",
    values_drop_na = TRUE
  ) %>% 
  mutate(week = as.numeric(week))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
# NOTE: It's apparently not possible to echo the source code in server context chunks,
# so their contents are manually duplicated into a non-evaluated code section for display
# only, and the code that is actually run. 
# The following is the 'real' code, with duplicated code below. I've tried to keep 
# them perfectly synced, but some inaccuracies may have slipped in over time. 

output$top_10 <- renderTable({
  # count weeks in ranking, then sort descending
  
  if (input$top_type == "artists") {
    weeks_in_ranking <- billboard_long %>% 
      count(artist)
  }
  if (input$top_type == "tracks") {
    weeks_in_ranking <- billboard_long %>%
      count(artist, track)
  }
  
  weeks_in_ranking %>% 
    arrange(-n) %>% 
    rename(`weeks` = n) %>% 
    head(10)
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$track_performance <- renderPlot({
  # filter data with user choices
  billboard_long %>%
    filter(artist == input$artist, track == input$track) %>%
    ggplot(aes(x = week, y = rank, group = track)) +
    coord_cartesian(ylim = c(100, 1)) +
    geom_line()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
# create an 'observer' that triggers an action when it's inputs change.
on_artist_change <- observe({
  #
  updateSelectInput(
    session,
    "track_v2",
    choices = billboard %>%
      filter(artist == input$artist_v2) %>%
      pull(track) %>% 
      unique()
  )
})

output$track_performance_v2 <- renderPlot({
  # filter data with user choices
  billboard_long %>%
    filter(artist == input$artist_v2, track == input$track_v2) %>%
    ggplot(aes(x = week, y = rank, group = track)) +
    coord_cartesian(ylim = c(100, 1)) +
    geom_line()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
# create a 'reactive' object that we can use to manually trigger track selection changes
selected_track <- reactiveVal()

# if a track is manually chosen, update the selected track.
on_track_changed <- observe({
  selected_track(input$track_v3)
})

# if the chosen artist changes, and only one track is available, set it as selected
# note that is there are multiple choices, we don't have to change the selected track,
# the selectInput widget will trigger a change event for us, and the `on_track_changed`
# observer we defined above will update the selected track.
on_artist_changed <- observe({
  .tracks <- billboard %>% 
    filter(artist == input$artist_v3) %>% 
    pull(track) %>%
    unique()
  
  if (length(.tracks) == 1) {
    selected_track(.tracks[1])
   }
})

# the UI for track selection is created dynamically, based on if there is any choice to
# make for the user.
output$track_v3_ui <- renderUI({
  req(input$artist_v3)
  
  .tracks <- billboard %>% 
    filter(artist == input$artist_v3) %>% 
    pull(track) %>%
    unique()
  
  if (length(.tracks) == 1) {
    # If there's only one option, show a non-interactive text element with the 
    # track name
    return(
      # shiny provides 'wrapper' functions to create basic html elements. In this 
      # case, we use a div containing a label (less common or conflicting html tags
      # are accessible through the `tags` list) and a paragraph (`p`) element.
      # The paragraph has a grey text colour to visually clue the user in (even more)
      # that this value cannot be changed (it is 'disabled').
      # For more info on html elements or css styling, see your favourite search engine.
      div(
      tags$label("Selected track:"),
      p(.tracks, style = "color: darkgrey;")
    ))
  } else {
    # if we have multiple choices, we use the selectInput shiny widget. 
    # Note that the input we return is essentially identical to the input we 
    # used in the UI in the previous examples.
    return(selectInput("track_v3", label = "Choose a track...", choices = .tracks))
  }
})


# the plot is essentially identical, but note that we now use `selected_track()`
# instead of `input$track_v3` directly.
output$track_performance_v3 <- renderPlot({
  # only continue when a track is selected.
  req(selected_track())
  
  billboard_long %>% 
    filter(artist == input$artist_v3, track == selected_track()) %>% 
    ggplot(aes(x = week, y = rank, group = track)) +
    coord_cartesian(ylim = c(100, 1)) +
    geom_line()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.5.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65]}},"value":[{"type":"character","attributes":{},"value":["base","bslib","cachem","cli","colorspace","compiler","datasets","digest","dplyr","ellipsis","evaluate","fansi","fastmap","forcats","generics","ggplot2","glue","graphics","grDevices","grid","gtable","hms","htmltools","httpuv","jquerylib","jsonlite","knitr","later","lifecycle","lubridate","magrittr","memoise","methods","mime","munsell","pillar","pkgconfig","promises","purrr","R6","Rcpp","readr","rlang","rmarkdown","rstudioapi","sass","scales","shiny","stats","stringi","stringr","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","utf8","utils","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["4.2.3","0.5.1","1.0.8","3.6.1","2.1-0","4.2.3","4.2.3","0.6.33","1.1.3","0.3.2","0.22","1.0.5","1.1.1","1.0.0","0.1.3","3.4.4","1.6.2","4.2.3","4.2.3","4.2.3","0.3.4","1.1.3","0.5.6.1","1.6.11","0.1.4","1.8.7","1.44","1.3.1","1.0.3","1.9.3","2.0.3","2.0.1","4.2.3","0.12","0.5.0","1.9.0","2.0.3","1.2.1","1.0.2","2.5.1","1.0.11","2.1.4","1.1.1","2.25","0.15.0","0.4.7","1.2.1","1.7.5.1","4.2.3","1.7.12","1.5.0","3.2.1","1.3.0","1.2.0","2.0.0","0.2.0","4.2.3","0.4.0","1.2.3","4.2.3","0.6.4","2.5.1","0.40","1.8-4","2.3.7"]}]}]}
</script>
<!--/html_preserve-->
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>